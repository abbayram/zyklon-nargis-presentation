<!DOCTYPE html>
<html lang="de">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Nargis Crisis Simulator - Visual Edition</title>
    <style>
        :root {
            --bg-color: #111;
            --terminal-green: #33ff33;
            --alert-red: #ff3333;
            --alert-orange: #ff9800;
            --ui-gray: #333;
            --text-white: #f0f0f0;
            --highlight: #00bcd4;
            --gold: #ffd700;
            --role-btn-color: #a88b8b; 
            --role-btn-border: #5d4a4a;
        }

        body {
            margin: 0;
            height: 100vh;
            background-color: var(--bg-color);
            color: var(--text-white);
            font-family: 'Courier New', Courier, monospace;
            display: flex;
            justify-content: center;
            align-items: center;
            overflow: hidden;
            user-select: none;
        }

        #game-stage {
            width: 1000px;
            height: 700px;
            background: #1a1a1a;
            border: 2px solid var(--ui-gray);
            position: relative;
            box-shadow: 0 0 30px rgba(0,0,0,0.6);
            display: flex;
            flex-direction: column;
            overflow: hidden;
        }

        /* --- SLIDE MANAGEMENT --- */
        .slide {
            position: absolute;
            top: 0; left: 0; width: 100%; height: 100%;
            padding: 40px;
            box-sizing: border-box;
            display: none;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            opacity: 0;
            transition: opacity 0.5s ease;
            background: #1a1a1a;
            z-index: 1;
        }
        .slide.active {
            display: flex;
            opacity: 1;
            z-index: 10;
        }

        h1 { text-transform: uppercase; letter-spacing: 2px; text-align: center; color: var(--terminal-green); text-shadow: 0 0 10px rgba(51, 255, 51, 0.5); margin-bottom: 30px;}
        p { font-size: 18px; line-height: 1.5; max-width: 800px; text-align: center; }

        /* --- BUTTONS --- */
        .btn {
            background: transparent;
            border: 2px solid var(--terminal-green);
            color: var(--terminal-green);
            padding: 15px 30px;
            font-size: 20px;
            font-family: inherit;
            cursor: pointer;
            margin-top: 20px;
            transition: all 0.2s;
            text-transform: uppercase;
            font-weight: bold;
        }
        .btn:hover { background: var(--terminal-green); color: black; box-shadow: 0 0 15px var(--terminal-green); }

        .btn-gold { border-color: var(--gold); color: var(--gold); }
        .btn-gold:hover { background: var(--gold); color: black; box-shadow: 0 0 15px var(--gold); }

        .btn-small { font-size: 14px; padding: 10px 20px; border: 1px solid #666; color: #888; margin-top: 0; }
        .btn-small:hover { border-color: white; color: white; background: transparent; box-shadow: none; }

        /* --- TYPEWRITER --- */
        .typewriter-text { color: var(--terminal-green); font-size: 24px; text-align: left; white-space: pre-wrap; min-height: 200px; width: 80%; }
        .cursor::after { content: '‚ñà'; animation: blink 0.8s infinite; }
        @keyframes blink { 0%, 100% { opacity: 1; } 50% { opacity: 0; } }

        /* --- ROLE CARDS --- */
        .role-container { display: flex; gap: 30px; width: 100%; justify-content: center; margin-top: 20px; }
        .role-card {
            background-color: var(--role-btn-color);
            border: 3px solid var(--role-btn-border);
            border-radius: 20px;
            padding: 25px;
            width: 240px;
            height: 260px;
            cursor: pointer;
            transition: transform 0.2s, box-shadow 0.2s;
            text-align: center;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: flex-start;
            box-shadow: 0 10px 15px rgba(0,0,0,0.3);
            color: #222;
        }
        .role-card:hover { transform: translateY(-8px); box-shadow: 0 15px 25px rgba(0,0,0,0.4); filter: brightness(1.1); }
        .role-icon { font-size: 50px; margin-bottom: 15px; display: block; }
        .role-title { font-size: 22px; font-weight: 900; margin-bottom: 10px; display: block; font-family: 'Segoe UI', Tahoma, sans-serif;}
        .role-desc { font-size: 13px; line-height: 1.4; color: #333; font-weight: 500; }

        /* --- BRIEFING --- */
        .briefing-box { border: 2px dashed var(--highlight); padding: 30px; background: rgba(0, 188, 212, 0.05); margin-bottom: 20px; width: 80%; }
        .briefing-box.collective { border-color: var(--gold); background: rgba(255, 215, 0, 0.05); }

        /* --- GAME SLIDERS --- */
        .budget-ui { width: 80%; background: #222; padding: 20px; border-radius: 4px; border: 1px solid #444; }
        .slider-row { display: flex; align-items: center; margin-bottom: 15px; }
        .slider-label { width: 280px; text-align: left; font-size: 16px; display: flex; align-items: center; gap: 10px;}
        input[type=range] { flex-grow: 1; margin: 0 15px; cursor: pointer; accent-color: var(--terminal-green); }
        .slider-val { width: 30px; text-align: right; font-weight: bold; color: var(--highlight); }
        .points-display { font-size: 24px; margin-bottom: 20px; color: var(--terminal-green); font-weight: bold; border-bottom: 1px solid #444; padding-bottom: 10px; width: 100%; text-align: center; }
        .points-display.error { color: var(--alert-red); animation: shake 0.5s; }
        @keyframes shake { 0%, 100% { transform: translateX(0); } 25% { transform: translateX(-5px); } 75% { transform: translateX(5px); } }

        /* --- RESULT --- */
        #outcome-image {
            max-width: 95%;
            max-height: 65vh;
            width: auto;
            height: auto;
            box-shadow: 0 15px 40px rgba(0,0,0,0.8);
            border-radius: 4px;
            margin-bottom: 15px;
        }
        #role-feedback { margin-top: 0px; font-style: italic; max-width: 85%; text-align: center; margin-bottom: 20px; font-size: 16px; }
        .text-red { color: var(--alert-red); }
        .text-orange { color: var(--alert-orange); }
        .text-green { color: var(--terminal-green); }

        .ai-credit {
            position: absolute;
            bottom: 10px;
            right: 15px;
            font-size: 11px;
            color: #555;
            pointer-events: none;
            opacity: 0.6;
            z-index: 50;
        }

        /* Collective Styling */
        .collective-mode-ui { border: 1px solid var(--gold); }
        .collective-mode-ui h1 { color: var(--gold); text-shadow: 0 0 10px rgba(255, 215, 0, 0.5); }
        .collective-mode-ui .points-display { color: var(--gold); }
        .collective-mode-ui input[type=range] { accent-color: var(--gold); }
        .collective-mode-ui .btn { border-color: var(--gold); color: var(--gold); }
        .collective-mode-ui .btn:hover { background: var(--gold); color: black; }

    </style>
</head>
<body>

<div id="game-stage">
    
    <div class="slide active" id="slide-intro">
        <div class="typewriter-text" id="intro-text"></div>
        <button class="btn" id="intro-btn" onclick="goToRoles()" style="opacity:0; pointer-events: none;">Verbindung herstellen >></button>
    </div>

    <div class="slide" id="slide-roles">
        <h1>Identit√§t W√§hlen</h1>
        <p style="margin-bottom: 20px;">W√§hle deine Perspektive oder starte direkt den Krisenstab.</p>
        
        <div class="role-container">
            <div class="role-card" onclick="selectRole('junta')">
                <div class="role-icon">‚öôÔ∏è</div>
                <span class="role-title">Milit√§rjunta</span>
                <span class="role-desc">Kontrolle. Stabilit√§t. Souver√§nit√§t. Ausl√§nder sind eine Gefahr f√ºr das Regime.</span>
            </div>
            <div class="role-card" onclick="selectRole('un')">
                <div class="role-icon">üí¨</div>
                <span class="role-title">Internationale Hilfe</span>
                <span class="role-desc">Rettung. Logistik. Menschenrechte. Wir m√ºssen helfen, egal wie.</span>
            </div>
            <div class="role-card" onclick="selectRole('local')">
                <div class="role-icon">üí°</div>
                <span class="role-title">Zivilbev√∂lkerung</span>
                <span class="role-desc">√úberleben. Schutz. Heimat. Wir kennen das Land und wollen √ºberleben.</span>
            </div>
        </div>

        <div style="margin-top: 40px; border-top: 1px solid #333; width: 80%; padding-top: 20px; text-align: center;">
            <p style="font-size: 14px; color: #666; margin-bottom: 10px;">Simulation √ºberspringen & gemeinsam entscheiden?</p>
            <button class="btn btn-gold btn-small" onclick="selectRole('collective')">Zum Krisenstab (Alle Parteien) >></button>
        </div>
    </div>

    <div class="slide" id="slide-briefing">
        <h1 id="briefing-header">Missionsbefehl</h1>
        <div class="briefing-box" id="briefing-container">
            <h3 id="briefing-role-title" style="color: var(--highlight); margin-top:0;">...</h3>
            <p id="briefing-text" style="text-align: left;">...</p>
        </div>
        <p style="font-size: 16px; color: #888;">Verteilen Sie Ihre <strong>10 Ressourcen-Punkte</strong>.</p>
        <button class="btn" onclick="goToGame()" id="start-sim-btn">Simulation Starten</button>
    </div>

    <div class="slide" id="slide-game">
        <div class="points-display">Verf√ºgbare Punkte: <span id="points-remaining">10</span> / 10</div>
        <div class="budget-ui">
            <div class="slider-row">
                <div class="slider-label">üì° Fr√ºhwarnsysteme</div>
                <input type="range" id="inp-warn" value="0" max="10" oninput="updateBudget()">
                <div class="slider-val">0</div>
            </div>
            <div class="slider-row">
                <div class="slider-label">üß± Schutzbauten / Mangroven</div>
                <input type="range" id="inp-protect" value="0" max="10" oninput="updateBudget()">
                <div class="slider-val">0</div>
            </div>
            <div class="slider-row">
                <div class="slider-label">üöö Infrastruktur / Evakuierung</div>
                <input type="range" id="inp-infra" value="0" max="10" oninput="updateBudget()">
                <div class="slider-val">0</div>
            </div>
            <div style="height: 1px; background: #444; margin: 15px 0;"></div>
            <div class="slider-row">
                <div class="slider-label" style="color: #ff6666;">üî´ Milit√§r & Kontrolle</div>
                <input type="range" id="inp-mil" value="0" max="10" oninput="updateBudget()">
                <div class="slider-val">0</div>
            </div>
            <div class="slider-row">
                <div class="slider-label" style="color: #ff6666;">üì¢ Staatsmedien & Propaganda</div>
                <input type="range" id="inp-prop" value="0" max="10" oninput="updateBudget()">
                <div class="slider-val">0</div>
            </div>
        </div>
        <button class="btn" onclick="checkSimulation()">Simulation ausf√ºhren</button>
    </div>

    <div class="slide" id="slide-result">
        <img id="outcome-image" src="" alt="Szenario Bild">
        <div id="role-feedback"></div>
        <div style="display: flex; gap: 20px;">
            <button class="btn btn-small" onclick="restartGame()">Rollen-Auswahl</button>
            <button class="btn btn-gold" id="collective-retry-btn" onclick="selectRole('collective')">Krisenstab einberufen</button>
        </div>
        <div class="ai-credit">Visuals erstellt mit Google Gemini AI</div>
    </div>

</div>

<script>
    let currentRole = "";
    let isCollectiveMode = false;
    const maxPoints = 10;
    
    // --- INTRO ---
    const introLines = "Initialisiere Crisis Management Simulator...\nStandort: Irawadi-Delta, Myanmar.\nZeitpunkt: April 2008.\n\nZyklon 'Nargis' (Kategorie 4) n√§hert sich.\nAnkunftszeit: 72 Stunden.\n\nDas Schicksal von 2 Millionen Menschen liegt in Ihrer Hand.";
    
    window.onload = function() {
        typeWriter(introLines, 'intro-text', 20, () => {
            const btn = document.getElementById('intro-btn');
            btn.style.opacity = 1; btn.style.pointerEvents = 'auto';
        });
    };

    function typeWriter(text, elementId, speed, callback) {
        let i = 0; let container = document.getElementById(elementId);
        container.innerHTML = ""; container.classList.add('cursor');
        function typing() {
            if (i < text.length) { container.innerHTML += text.charAt(i); i++; setTimeout(typing, speed); }
            else { container.classList.remove('cursor'); if(callback) callback(); }
        }
        typing();
    }

    // --- NAVIGATION ---
    function showSlide(id) {
        document.querySelectorAll('.slide').forEach(s => s.classList.remove('active'));
        document.getElementById(id).classList.add('active');
    }

    function resetUIStyles() {
        const list = ['slide-briefing', 'slide-game'];
        list.forEach(id => document.getElementById(id).classList.remove('collective-mode-ui'));
        document.getElementById('briefing-container').classList.remove('collective');
        document.getElementById('briefing-role-title').style.color = "var(--highlight)";
        document.getElementById('briefing-header').innerText = "Missionsbefehl";
    }

    function selectRole(role) {
        currentRole = role;
        const titleEl = document.getElementById('briefing-role-title');
        const textEl = document.getElementById('briefing-text');
        document.querySelectorAll('input[type=range]').forEach(i => i.value = 0);
        resetUIStyles();

        if (role === 'junta') {
            isCollectiveMode = false;
            titleEl.innerText = "ROLLE: GENERAL (SPDC)";
            textEl.innerHTML = "Priorit√§t: <strong>Nationale Sicherheit</strong>. Das Referendum darf nicht gest√∂rt werden. Ausl√§ndische Hilfe ist eine Gefahr f√ºr die Souver√§nit√§t.";
        } else if (role === 'un') {
            isCollectiveMode = false;
            titleEl.innerText = "ROLLE: UN-KOORDINATOR";
            textEl.innerHTML = "Priorit√§t: <strong>Humanit√§re Hilfe</strong>. Sch√ºtzen Sie Leben durch Information und Logistik. Ignorieren Sie politische H√ºrden.";
        } else if (role === 'local') {
            isCollectiveMode = false;
            titleEl.innerText = "ROLLE: DORFVORSTEHER";
            textEl.innerHTML = "Priorit√§t: <strong>√úberleben</strong>. Sie brauchen Bunker und Mangroven, um Ihre Heimat vor der Flut zu retten.";
        } else if (role === 'collective') {
            isCollectiveMode = true;
            document.getElementById('slide-briefing').classList.add('collective-mode-ui');
            document.getElementById('slide-game').classList.add('collective-mode-ui');
            document.getElementById('briefing-container').classList.add('collective');
            document.getElementById('briefing-header').innerText = "GEMEINSAMER KRISENSTAB";
            titleEl.innerText = "SZENARIO: DER RUNDE TISCH";
            titleEl.style.color = "var(--gold)";
            textEl.innerHTML = "Alle Parteien m√ºssen sich auf EIN Budget einigen. Finden Sie einen Kompromiss zwischen Kontrolle, Warnung und Schutz.";
        }
        showSlide('slide-briefing');
    }

    function goToGame() { showSlide('slide-game'); updateBudget(); }
    function restartGame() { showSlide('slide-roles'); }

    function updateBudget() {
        const inputs = document.querySelectorAll('input[type=range]');
        let sum = 0;
        inputs.forEach(inp => {
            let val = parseInt(inp.value);
            sum += val;
            inp.nextElementSibling.innerText = val;
        });
        const display = document.getElementById('points-remaining');
        const remaining = maxPoints - sum;
        display.innerText = remaining;
        if (remaining < 0) {
            display.parentElement.classList.add('error');
            display.innerText = "LIMIT √úBERSCHRITTEN (" + remaining + ")";
        } else {
            display.parentElement.classList.remove('error');
            display.parentElement.innerText = "Verf√ºgbare Punkte: " + remaining + " / 10";
        }
    }

    // --- CHECK SIMULATION & LOAD IMAGES ---
    function checkSimulation() {
        const warn = parseInt(document.getElementById('inp-warn').value);
        const protect = parseInt(document.getElementById('inp-protect').value);
        const infra = parseInt(document.getElementById('inp-infra').value);
        const mil = parseInt(document.getElementById('inp-mil').value);
        const prop = parseInt(document.getElementById('inp-prop').value);
        if ((warn + protect + infra + mil + prop) > maxPoints) { alert("Zu viele Punkte!"); return; }

        let imageName = ""; let feedback = ""; let fColor = "";
        const path = "assets/";

        // 1. Der Eiserne Vorhang
        if (mil + prop >= 6) {
            imageName = "ending1.png"; fColor = "text-red";
            feedback = isCollectiveMode ? "Der Krisenstab scheiterte an der Paranoia des Milit√§rs." : "Sicherheit wurde √ºber Leben gestellt.";
        }
        // 2. T√∂dliche Klarheit
        else if (warn >= 6 && protect <= 1 && infra <= 1) {
            imageName = "ending2.png"; fColor = "text-red";
            feedback = "Die Menschen wussten vom Tod, konnten ihm aber nicht entkommen.";
        }
        // 3. Die schwimmenden Friedh√∂fe
        else if (infra >= 5 && protect <= 1) {
            imageName = "ending3.png"; fColor = "text-red";
            feedback = "Ohne K√ºstenschutz wurde die Flucht zur Todesfalle.";
        }
        // 4. Das Mangroven-Wunder
        else if (protect >= 5 && warn >= 3) {
            imageName = "ending4.png"; fColor = "text-green";
            feedback = "Ein Triumph der Vernunft. Die Natur bot den besten Schutz.";
        }
        // 5. Exil in der Heimat
        else if (infra >= 4 && warn >= 4) {
            imageName = "ending5.png"; fColor = "text-orange";
            feedback = "Leben gerettet, aber die Existenzgrundlage ist weggesp√ºlt.";
        }
        // 6. Die Festung im Schlamm
        else if (protect >= 6 && warn <= 1) {
            imageName = "ending6.png"; fColor = "text-orange";
            feedback = "Massive Bunker n√ºtzen nichts, wenn niemand rechtzeitig gewarnt wird.";
        }
        // 7. Zusammenbruch der Ordnung
        else if (mil === 0 && warn + infra >= 5) {
            imageName = "ending7.png"; fColor = "text-orange";
            feedback = "Humanit√§rer Erfolg, gefolgt von politischem Chaos.";
        }
        // 8. Staatsversagen
        else {
            imageName = "ending8.png"; fColor = "text-red";
            feedback = "Zu wenig, zu sp√§t. Die Planung war nicht konsequent genug.";
        }

        document.getElementById('outcome-image').src = path + imageName;
        const fb = document.getElementById('role-feedback');
        fb.innerText = feedback; fb.className = fColor;
        document.getElementById('collective-retry-btn').innerText = isCollectiveMode ? "Neue Verhandlung" : "Runden Tisch einberufen";
        showSlide('slide-result');
    }
</script>
</body>
</html>
