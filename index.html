<!DOCTYPE html>
<html lang="de">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Nargis â€“ Delta Kommando 2008</title>
    <style>
        :root {
            --bg-color: #0a0a0a;
            --terminal-green: #33ff33;
            --alert-red: #ff3333;
            --alert-orange: #ff9800;
            --ui-gray: #222;
            --text-white: #e0e0e0;
            --highlight: #00bcd4;
            --gold: #ffd700;
            --role-btn-color: #a88b8b; 
            --role-btn-border: #5d4a4a;
        }

        body {
            margin: 0;
            height: 100vh;
            background-color: var(--bg-color);
            color: var(--text-white);
            font-family: 'Courier New', Courier, monospace;
            display: flex;
            justify-content: center;
            align-items: center;
            overflow: hidden;
        }

        #game-stage {
            width: 1000px;
            height: 700px;
            background: #111;
            border: 2px solid var(--ui-gray);
            position: relative;
            box-shadow: 0 0 40px rgba(0,0,0,0.8);
            display: flex;
            flex-direction: column;
            overflow: hidden;
        }

        .slide {
            position: absolute;
            top: 0; left: 0; width: 100%; height: 100%;
            padding: 40px;
            box-sizing: border-box;
            display: none;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            opacity: 0;
            transition: opacity 0.5s ease;
            background: #111;
            z-index: 1;
        }
        .slide.active { display: flex; opacity: 1; z-index: 10; }

        h1 { text-transform: uppercase; letter-spacing: 3px; color: var(--terminal-green); text-shadow: 0 0 10px rgba(51, 255, 51, 0.3); margin-bottom: 30px;}

        /* --- ZÃ„HLER --- */
        .points-tracker {
            font-size: 28px;
            font-weight: bold;
            margin-bottom: 20px;
            padding: 10px 20px;
            border: 1px solid var(--ui-gray);
            background: rgba(0,0,0,0.3);
            transition: color 0.3s, border-color 0.3s;
        }
        .points-tracker.warning {
            color: var(--alert-red);
            border-color: var(--alert-red);
            animation: pulse 1s infinite;
        }
        @keyframes pulse { 0% { opacity: 1; } 50% { opacity: 0.6; } 100% { opacity: 1; } }

        /* --- BUTTONS --- */
        .btn {
            background: transparent;
            border: 2px solid var(--terminal-green);
            color: var(--terminal-green);
            padding: 15px 35px;
            font-size: 20px;
            font-family: inherit;
            cursor: pointer;
            margin-top: 20px;
            transition: all 0.2s;
            text-transform: uppercase;
        }
        .btn:hover:not(:disabled) { background: var(--terminal-green); color: black; box-shadow: 0 0 20px var(--terminal-green); }
        .btn:disabled { border-color: #444; color: #444; cursor: not-allowed; }

        .btn-gold { border-color: var(--gold); color: var(--gold); }
        .btn-gold:hover { background: var(--gold); color: black; }

        /* --- TYPEWRITER --- */
        .typewriter-text { color: var(--terminal-green); font-size: 22px; text-align: left; white-space: pre-wrap; min-height: 250px; width: 85%; line-height: 1.4; }
        .cursor::after { content: 'â–ˆ'; animation: blink 0.8s infinite; }
        @keyframes blink { 0%, 100% { opacity: 1; } 50% { opacity: 0; } }

        /* --- ROLE CARDS --- */
        .role-container { display: flex; gap: 20px; margin-top: 20px; }
        .role-card {
            background-color: var(--role-btn-color);
            border: 3px solid var(--role-btn-border);
            border-radius: 15px;
            padding: 20px;
            width: 230px;
            cursor: pointer;
            transition: transform 0.2s;
            color: #111;
            text-align: center;
        }
        .role-card:hover { transform: translateY(-5px); filter: brightness(1.1); }
        .role-title { font-size: 20px; font-weight: 900; display: block; margin-bottom: 10px; font-family: sans-serif; text-transform: uppercase; }
        .role-desc { font-size: 13px; font-weight: 500; }

        /* --- SLIDERS --- */
        .budget-ui { width: 85%; background: #1a1a1a; padding: 25px; border: 1px solid #333; }
        .slider-row { display: flex; align-items: center; margin-bottom: 18px; }
        .slider-label { width: 320px; text-align: left; font-size: 15px; }
        input[type=range] { flex-grow: 1; cursor: pointer; accent-color: var(--terminal-green); }
        .slider-val { width: 40px; text-align: right; font-weight: bold; color: var(--highlight); margin-left: 10px;}

        /* --- RESULT --- */
        #outcome-image { max-width: 95%; max-height: 60vh; border: 1px solid #444; margin-bottom: 10px; }
        #role-feedback { font-style: italic; font-size: 16px; margin-bottom: 20px; }

        .ai-credit { position: absolute; bottom: 10px; right: 15px; font-size: 10px; color: #444; opacity: 0.7; }

        .collective-mode-ui { border: 2px solid var(--gold); }
        .collective-mode-ui h1 { color: var(--gold); }
        .collective-mode-ui input[type=range] { accent-color: var(--gold); }
    </style>
</head>
<body>

<div id="game-stage">
    
    <div class="slide active" id="slide-intro">
        <div class="typewriter-text" id="intro-text"></div>
        <button class="btn" id="intro-btn" onclick="goToRoles()" style="opacity:0; pointer-events: none;">>> SYSTEM INITIALISIEREN</button>
    </div>

    <div class="slide" id="slide-roles">
        <h1>AUTORISIERUNG ERFORDERLICH</h1>
        <p>WÃ¤hlen Sie Ihre operative Ebene im Delta-Kommando.</p>
        <div class="role-container">
            <div class="role-card" onclick="selectRole('junta')">
                <span class="role-title">MILITÃ„RJUNTA</span>
                <span class="role-desc">Schutz der SouverÃ¤nitÃ¤t. Kontrolle des Referendums. Misstrauen gegenÃ¼ber dem Ausland.</span>
            </div>
            <div class="role-card" onclick="selectRole('un')">
                <span class="role-title">HILFS-KOORDINATOR</span>
                <span class="role-desc">Logistik unter Extrembedingungen. Rettung um jeden Preis. Politische HÃ¼rden ignorieren.</span>
            </div>
            <div class="role-card" onclick="selectRole('local')">
                <span class="role-title">DORFVORSTAND</span>
                <span class="role-desc">Ãœberleben der Gemeinschaft. Schutz des Bodens. Verteidigung gegen die Flut.</span>
            </div>
        </div>
        <button class="btn btn-gold" style="margin-top: 40px; font-size: 14px;" onclick="selectRole('collective')">Krisenstab einberufen (Gemeinsame Entscheidung)</button>
    </div>

    <div class="slide" id="slide-briefing">
        <h1 id="briefing-header">EINSATZBEFEHL</h1>
        <div style="border: 1px dashed var(--highlight); padding: 25px; width: 80%; margin-bottom: 20px; background: rgba(0,188,212,0.05);">
            <h3 id="briefing-role-title" style="color: var(--highlight); margin-top:0;"></h3>
            <p id="briefing-text" style="text-align: left; font-size: 16px;"></p>
        </div>
        <button class="btn" onclick="goToGame()">OPERATIVE PHASE STARTEN</button>
    </div>

    <div class="slide" id="slide-game">
        <div id="main-counter" class="points-tracker">EINHEITEN: 0 / 10</div>
        
        <div class="budget-ui">
            <div class="slider-row">
                <div class="slider-label">ðŸ“¡ FrÃ¼hwarn-Netzwerke</div>
                <input type="range" class="res-slider" id="inp-warn" value="0" max="10" oninput="updateBudget()">
                <div class="slider-val">0</div>
            </div>
            <div class="slider-row">
                <div class="slider-label">ðŸ§± KÃ¼stenschutz / Mangroven</div>
                <input type="range" class="res-slider" id="inp-protect" value="0" max="10" oninput="updateBudget()">
                <div class="slider-val">0</div>
            </div>
            <div class="slider-row">
                <div class="slider-label">ðŸšš Evakuierung & Logistik</div>
                <input type="range" class="res-slider" id="inp-infra" value="0" max="10" oninput="updateBudget()">
                <div class="slider-val">0</div>
            </div>
            <div style="height: 1px; background: #333; margin: 15px 0;"></div>
            <div class="slider-row">
                <div class="slider-label" style="color: #ff6666;">ðŸ”« MilitÃ¤rische Absicherung</div>
                <input type="range" class="res-slider" id="inp-mil" value="0" max="10" oninput="updateBudget()">
                <div class="slider-val">0</div>
            </div>
            <div class="slider-row">
                <div class="slider-label" style="color: #ff6666;">ðŸ“¢ Informations-Zensur</div>
                <input type="range" class="res-slider" id="inp-prop" value="0" max="10" oninput="updateBudget()">
                <div class="slider-val">0</div>
            </div>
        </div>
        <button class="btn" id="submit-btn" onclick="checkSimulation()">BEFEHLE BESTÃ„TIGEN</button>
    </div>

    <div class="slide" id="slide-result">
        <img id="outcome-image" src="" alt="Lagebericht">
        <div id="role-feedback"></div>
        <div style="display: flex; gap: 20px;">
            <button class="btn btn-small" style="font-size: 14px; border-width: 1px;" onclick="location.reload()">NEUSTART</button>
            <button class="btn btn-gold btn-small" id="collective-retry-btn" onclick="selectRole('collective')">RUNDEN TISCH EINBERUFEN</button>
        </div>
        <div class="ai-credit">Visuals generiert via Google Gemini AI</div>
    </div>

</div>

<script>
    let currentRole = "";
    let isCollectiveMode = false;

    const introLines = "SYSTEM-LOGIN: DELTA-KOMMANDO [AUTORISIERT]\nSTANDORT: IRAWADI-DELTA, MYANMAR\nZEITPUNKT: 02. MAI 2008 | 04:00 UHR\n\nWARNUNG: ZYKLON 'NARGIS' HAT KATEGORIE 4 ERREICHT.\nWINDGESCHWINDIGKEITEN BIS ZU 215 KM/H.\nEINSCHLAG IN 72 STUNDEN UNVERMEIDLICH.\n\nDIE FLUTWELLE WIRD KOMMEN. DIE REAKTION DES REGIMES IST GELÃ„HMT.\nDREI MÃ„CHTE RINGEN UM DIE KONTROLLE.\nIHRE ENTSCHEIDUNG BESTIMMT, WER DEN MORGEN ERLEBT.";

    window.onload = function() {
        typeWriter(introLines, 'intro-text', 20, () => {
            const btn = document.getElementById('intro-btn');
            btn.style.opacity = 1;
            btn.style.pointerEvents = 'auto';
        });
    };

    function typeWriter(text, elementId, speed, callback) {
        let i = 0; let container = document.getElementById(elementId);
        container.innerHTML = ""; container.classList.add('cursor');
        function typing() {
            if (i < text.length) { container.innerHTML += text.charAt(i); i++; setTimeout(typing, speed); }
            else { container.classList.remove('cursor'); if(callback) callback(); }
        }
        typing();
    }

    function showSlide(id) {
        document.querySelectorAll('.slide').forEach(s => s.classList.remove('active'));
        document.getElementById(id).classList.add('active');
    }

    function selectRole(role) {
        currentRole = role;
        const titleEl = document.getElementById('briefing-role-title');
        const textEl = document.getElementById('briefing-text');
        document.querySelectorAll('.res-slider').forEach(i => i.value = 0);
        
        document.getElementById('slide-game').classList.remove('collective-mode-ui');
        document.getElementById('slide-briefing').classList.remove('collective-mode-ui');

        if (role === 'junta') {
            titleEl.innerText = "EBENE: OBERKOMMANDO (SPDC)";
            textEl.innerHTML = "Das Referendum hat Vorrang. StabilitÃ¤t ist wichtiger als Hilfe. Verhindern Sie, dass auslÃ¤ndische Akteure das Chaos nutzen, um Unruhe zu stiften.";
        } else if (role === 'un') {
            titleEl.innerText = "EBENE: INTERNATIONALE KOORDINATION";
            textEl.innerHTML = "Die Zeit lÃ¤uft ab. Mobilisieren Sie Ressourcen fÃ¼r Warnung und Evakuierung. Jede Minute, die wir mit Verhandlungen verlieren, kostet Menschenleben.";
        } else if (role === 'local') {
            titleEl.innerText = "EBENE: LOKALE VERWALTUNG";
            textEl.innerHTML = "Wir sind auf uns allein gestellt. Investieren Sie in Deiche und Bunker. Wenn die Flut kommt, ist der Boden unser einziger Schutz.";
        } else if (role === 'collective') {
            isCollectiveMode = true;
            document.getElementById('slide-game').classList.add('collective-mode-ui');
            document.getElementById('slide-briefing').classList.add('collective-mode-ui');
            titleEl.innerText = "EBENE: GEMEINSAMER KRISENSTAB";
            textEl.innerHTML = "Ein gezwungener Kompromiss. Alle Parteien mÃ¼ssen sich auf eine Strategie einigen. Finden Sie die Balance zwischen Sicherheit und Rettung.";
        }
        showSlide('slide-briefing');
    }

    function goToRoles() { showSlide('slide-roles'); }
    function goToGame() { showSlide('slide-game'); updateBudget(); }

    function updateBudget() {
        const sliders = document.querySelectorAll('.res-slider');
        let total = 0;
        sliders.forEach(s => {
            let val = parseInt(s.value);
            total += val;
            s.nextElementSibling.innerText = val;
        });

        const counter = document.getElementById('main-counter');
        const submitBtn = document.getElementById('submit-btn');
        counter.innerText = `EINHEITEN: ${total} / 10`;

        if (total > 10) {
            counter.classList.add('warning');
            submitBtn.disabled = true;
        } else {
            counter.classList.remove('warning');
            submitBtn.disabled = false;
        }
    }

    function checkSimulation() {
        const warn = parseInt(document.getElementById('inp-warn').value);
        const protect = parseInt(document.getElementById('inp-protect').value);
        const infra = parseInt(document.getElementById('inp-infra').value);
        const mil = parseInt(document.getElementById('inp-mil').value);
        const prop = parseInt(document.getElementById('inp-prop').value);
        
        let imageName = ""; let feedback = ""; let fColor = "";
        const path = "assets/";

        if (mil + prop >= 6) {
            imageName = "ending1.png"; fColor = "text-red";
            feedback = "Die Kontrolle wurde gewahrt. Das Schweigen des Deltas ist nun absolut.";
        } else if (warn >= 6 && protect <= 1 && infra <= 1) {
            imageName = "ending2.png"; fColor = "text-red";
            feedback = "TÃ¶dliche Klarheit: Alle wussten vom Tod, niemand konnte ihm entkommen.";
        } else if (infra >= 5 && protect <= 1) {
            imageName = "ending3.png"; fColor = "text-red";
            feedback = "Die Fluchtwege wurden zu GrÃ¤bern. Die Welle war schneller als die Boote.";
        } else if (protect >= 5 && warn >= 3) {
            imageName = "ending4.png"; fColor = "text-green";
            feedback = "Das Mangroven-Wunder: Die Natur hielt stand. Das Delta Ã¼berlebt.";
        } else if (infra >= 4 && warn >= 4) {
            imageName = "ending5.png"; fColor = "text-orange";
            feedback = "Die HÃ¤user sind fort, aber die Menschen leben. Ein hoher Preis fÃ¼r das Exil.";
        } else if (protect >= 6 && warn <= 1) {
            imageName = "ending6.png"; fColor = "text-orange";
            feedback = "Stumme Festungen: Die Bunker blieben leer, weil der Ruf nicht gehÃ¶rt wurde.";
        } else if (mil === 0 && warn + infra >= 5) {
            imageName = "ending7.png"; fColor = "text-orange";
            feedback = "HumanitÃ¤rer Sieg â€“ politisches Chaos. Das Delta atmet, das Regime wankt.";
        } else {
            imageName = "ending8.png"; fColor = "text-red";
            feedback = "Halbherzige Befehle fÃ¼hren zu ganzem Leid. Die Chance wurde vertan.";
        }

        const imgEl = document.getElementById('outcome-image');
        imgEl.src = path + imageName;
        imgEl.onerror = function() { this.alt = "Fehler: Bild " + imageName + " nicht in /assets gefunden."; };
        
        const fb = document.getElementById('role-feedback');
        fb.innerText = feedback;
        fb.style.color = (fColor === "text-green") ? "#33ff33" : (fColor === "text-orange" ? "#ff9800" : "#ff3333");
        
        showSlide('slide-result');
    }
</script>
</body>
</html>
